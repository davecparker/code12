this = {}; _fn = {}   -- This file was generated by Code12 from "LineHitTest.java"
package.path = package.path .. ';../../Desktop/Code12/?.lua;../../../Desktop/Code12/?.lua'
require('Code12.api')

    
    
        
        
    
    this.objs = nil; 
    this.clickedObj = nil
    this.startSpeed = 0; 
    this.speed = 0; 
    this.dx = 0
    this.dy = 0
    
    function _fn.start()
        
        this.speed = 1 / ct.getPixelsPerUnit()
        this.startSpeed = this.speed
        
        this.objs = { length = 19, default = nil }
        
        ct.checkArrayIndex(this.objs, 0); this.objs[1+(0)] = ct.rect(25, 90, 15, 10, "gray")
        ct.checkArrayIndex(this.objs, 1); this.objs[1+(1)] = ct.circle(75, 90, 10, "gray")
        
        ct.checkArrayIndex(this.objs, 2); this.objs[1+(2)] = ct.line(2, 0, 98, 0, "blue")
        ct.checkArrayIndex(this.objs, 3); this.objs[1+(3)] = ct.line(2, 100, 98, 100, "blue")
        ct.checkArrayIndex(this.objs, 4); this.objs[1+(4)] = ct.line(0, 2, 0, 98, "blue")
        ct.checkArrayIndex(this.objs, 5); this.objs[1+(5)] = ct.line(100, 2, 100, 98, "blue")
        local i = 2; while i <= 5 do
            ct.checkArrayIndex(this.objs, i); this.objs[1+(i)].lineWidth = 5; i = i + 1; end
        -- static lines in center cross
        ct.checkArrayIndex(this.objs, 6); this.objs[1+(6)] = ct.line(30, 30, 70, 70, "blue")
        ct.checkArrayIndex(this.objs, 7); this.objs[1+(7)] = ct.line(30, 70, 70, 30, "blue")
        ct.checkArrayIndex(this.objs, 8); this.objs[1+(8)] = ct.line(50, 25, 50, 75, "blue")
        ct.checkArrayIndex(this.objs, 9); this.objs[1+(9)] = ct.line(25, 50, 75, 50, "blue")
        -- moving lines
        ct.checkArrayIndex(this.objs, 10); this.objs[1+(10)] = ct.line(40, 5, 60, 5)
        ct.checkArrayIndex(this.objs, 11); this.objs[1+(11)] = ct.line(20, 5, 35, 5)
        ct.checkArrayIndex(this.objs, 12); this.objs[1+(12)] = ct.line(65, 5, 80, 5)
        local i = 10; while i <= 12 do
            ct.checkArrayIndex(this.objs, i); this.objs[1+(i)].ySpeed = this.startSpeed; i = i + 1; end
        ct.checkArrayIndex(this.objs, 13); this.objs[1+(13)] = ct.line(5, 40, 5, 60)
        ct.checkArrayIndex(this.objs, 14); this.objs[1+(14)] = ct.line(5, 20, 5, 35)
        ct.checkArrayIndex(this.objs, 15); this.objs[1+(15)] = ct.line(5, 65, 5, 80)
        local i = 13; while i <= 15 do
            ct.checkArrayIndex(this.objs, i); this.objs[1+(i)].xSpeed = this.startSpeed; i = i + 1; end
        ct.checkArrayIndex(this.objs, 16); this.objs[1+(16)] = ct.line(40, 90, 60, 90)
        ct.checkArrayIndex(this.objs, 16); this.objs[1+(16)].ySpeed = this.startSpeed
        ct.checkArrayIndex(this.objs, 17); this.objs[1+(17)] = ct.line(90, 40, 90, 60)
        ct.checkArrayIndex(this.objs, 17); this.objs[1+(17)].xSpeed = this.startSpeed
        ct.checkArrayIndex(this.objs, 18); this.objs[1+(18)] = ct.line(95, 95, 90, 90)
        ct.checkArrayIndex(this.objs, 18); this.objs[1+(18)].xSpeed = -this.startSpeed
        ct.checkArrayIndex(this.objs, 18); this.objs[1+(18)].ySpeed = -this.startSpeed
        
        local i = 0; while i < this.objs.length do
            
            ct.checkArrayIndex(this.objs, i); this.objs[1+(i)].clickable = true
            if i > 1 then
                ct.checkArrayIndex(this.objs, i); this.objs[1+(i)].group = "line"; end
        i = i + 1; end
        
    end
    
    function _fn.update()
        
        -- Reset obj colors
        local i = 0; while i < this.objs.length do
            
            local obj = ct.indexArray(this.objs, i)
            local group = obj.group
            if (group == "line") then
                obj:setLineColor("black"); 
            else 
                obj:setFillColor("gray"); end
        i = i + 1; end
        -- Check if any objects hit each other and change their color if so
        local i = 0; while i < this.objs.length do
            
            local obj1 = ct.indexArray(this.objs, i)
            local group1 = obj1.group
            local obj1HitNothing = true
            local j = i + 1; while j < this.objs.length do
                
                local obj2 = ct.indexArray(this.objs, j)
                local group2 = obj2.group
                if obj1:hit(obj2) then
                    
                    obj1HitNothing = false
                    obj1.xSpeed = 0
                    obj1.ySpeed = 0
                    obj2.xSpeed = 0
                    obj2.ySpeed = 0
                    if (group1 == "line") then
                        obj1:setLineColor("red"); 
                    else 
                        obj1:setFillColor("red"); end
                    if (group2 == "line") then
                        obj2:setLineColor("red"); 
                    else 
                        obj2:setFillColor("red"); end
                end
            j = j + 1; end
        i = i + 1; end
    end
    
    function _fn.onMousePress(obj, x, y)
        
        if obj == nil then
            
            this.clickedObj = nil
        
        else 
            
            this.clickedObj = obj
            this.dx = x - obj.x
            this.dy = y - obj.y
            ct.println(obj:toString() .. " clicked")
        end
    end
    
    function _fn.onMouseDrag(obj, x, y)
        
        if obj ~= nil then
            
            obj.x = x - this.dx
            obj.y = y - this.dy
        end
    end
    
    
    function _fn.onKeyPress(keyName)
        
        if (keyName == "t") then
            
            if this.clickedObj ~= nil then
                
                this.clickedObj.lineWidth = this.clickedObj.lineWidth + 1
            end
        
        elseif this.clickedObj ~= nil then
            
            if (keyName == "up") then
                
                this.clickedObj.ySpeed = -this.speed
                this.clickedObj.xSpeed = 0
            
            elseif (keyName == "down") then
                
                this.clickedObj.ySpeed = this.speed
                this.clickedObj.xSpeed = 0
                
            
            elseif (keyName == "left") then
                
                this.clickedObj.xSpeed = -this.speed
                this.clickedObj.ySpeed = 0
            
            elseif (keyName == "right") then
                
                this.clickedObj.xSpeed = this.speed
                this.clickedObj.ySpeed = 0
            
            elseif (keyName == "space") then
                
                this.clickedObj.xSpeed = 0
                this.clickedObj.ySpeed = 0
            end
        end
    end
    
